todo: move all json logic in here.